{"options":{"viewOn":"matches","pipeline":[{"$facet":{"home_team_events":[{"$unwind":{"path":"$home_team_events"}},{"$project":{"against":"$away_team_country","event":"$home_team_events","country":"$home_team_country"}}],"away_team_events":[{"$unwind":{"path":"$away_team_events"}},{"$project":{"event":"$away_team_events","country":"$away_team_country","against":"$home_team_country"}}]}},{"$project":{"events":{"$concatArrays":["$home_team_events","$away_team_events"]}}},{"$unwind":{"path":"$events"}},{"$replaceRoot":{"newRoot":"$events"}},{"$project":{"extra_info":"$event.extra_info","country":{"$numberInt":"1"},"against":{"$numberInt":"1"},"eventId":"$event.id","type_of_event":"$event.type_of_event","player":"$event.player","time":"$event.time"}}]},"indexes":[],"collectionName":"events","type":"view"}