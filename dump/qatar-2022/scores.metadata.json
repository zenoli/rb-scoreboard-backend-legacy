{"options":{"viewOn":"participant_match_events","pipeline":[{"$match":{"type_of_event":{"$in":["goal","booking","assist","clean_sheet"]}}},{"$group":{"_id":"$participant","goals":{"$sum":{"$cond":[{"$eq":["$type_of_event","goal"]},{"$numberInt":"1"},{"$numberInt":"0"}]}},"bookings":{"$sum":{"$cond":[{"$eq":["$type_of_event","booking"]},{"$numberInt":"1"},{"$numberInt":"0"}]}},"assists":{"$sum":{"$cond":[{"$eq":["$type_of_event","assist"]},"$assists",{"$numberInt":"0"}]}},"clean_sheets":{"$sum":{"$cond":[{"$eq":["$type_of_event","clean_sheet"]},{"$numberInt":"1"},{"$numberInt":"0"}]}}}},{"$addFields":{"participant":"$_id"}},{"$project":{"_id":{"$numberInt":"0"}}}]},"indexes":[],"collectionName":"scores","type":"view"}